(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{186:function(t,a,e){"use strict";e.r(a);var s=e(258),i=e(244),r=e(250),l=e(265),o=e(420),n=e(421),c=e(413),d=e(246),m=e(256),u=(e(7),{name:"News",components:{Navbar:()=>e.e(3).then(e.bind(null,181))},props:["lang","id"],data:()=>({csrf:document.querySelector('meta[name="csrf-token"]').getAttribute("content"),updatePage:!1,form:[],image:"",lang_id:2,updated:!1}),created:function(){this.lang_id=Vue.ls.get("language",1);let t=this;Vue.ls.on("language",(function(a){t.lang_id=a}));for(let t=1;t<4;t++)Vue.set(this.form,t,{valid:!1,available:1,header:"",description:"",name:"",nameRules:[t=>!!t||"Name is required"],image:"",file:null,activeItem:t,errors:"",success:""})},methods:{imageChosen(t){this.form[this.lang_id].image=t.target.files[0].name,this.form[this.lang_id].file=t.target.files[0]},setActive(t,a){var e={...this.form},s=this.lang_id;this.lang_id=a,Vue.ls.set("language",parseInt(a)),Array.from(this.$store.state.dataForm).find(t=>t.activeItem===a)?this.form=this.$store.state.dataForm:(this.updatePage||(this.form.image="",this.form.file=null),this.form.name="",this.form.description=""),this.updatePage&&s!==a&&this.$store.dispatch("singleNews",{id:this.$route.params.id}).then(()=>{let t=[];for(var e in this.news[a].id?t=this.news[a]:((t=(t=Object.keys(this.news).map((t,a)=>{if(this.news[t].lang_id)return this.news[t]})).find(t=>null!==t.id)).name="",t.description=""),this.form[a])if(t[e])if(Array.isArray(this.form[a][e])){for(var s in this.form[a][e])if(t[e][s])for(var i in this.form[a][e][s])this.form[a][e][s][i]=t[e][s][i]}else this.form[a][e]=t[e],this.form[a].available=parseInt(t.available),t.image&&(this.form[a].image=t.image.split("/").pop())});for(let t=1;t<=3;t++)e[t].image=this.form[2].image||this.form[1].image||this.form[3].image,e[t].available=this.form[t].available;this.$store.dispatch("dataForm",e)},isActive(t){return this.getRoute(this.$route.path)&&(this.updatePage=!0),parseInt(t)===parseInt(this.lang_id)},discard(){this.$refs.form.reset(),this.form[this.lang_id].image="",this.form[this.lang_id].imageFile=null,this.updatePage&&this.$store.dispatch("page",this.$route.params.pagination),this.$router.go(-1)},send(){let t=new FormData,a=!1;this.form.forEach((e,s)=>{e.name&&(t.append("file",e.file),t.append("data[]",JSON.stringify(e))),a=!0,e.name||s!==this.lang_id||(this.form[s].errors="Some fields needs to be completed",a=!1)}),a&&axios.post("/admin/news/add",t).then(t=>{200===t.status&&t.data.error,this.$router.go(-1)})},update(){this.form.forEach((t,a)=>{var e;t.name?((e=new FormData).append("file",t.file),e.append("data",JSON.stringify(t)),axios.post("/admin/news/"+this.$route.params.id,e).then(t=>{void 0!==this.form[a+1]&&this.form[a+1].name||(this.form[a].success="Updated successfully",setTimeout(()=>{this.form[a].success=""},3e3))})):t.name||a!==this.lang_id||(this.form[a].errors="Some fields needs to be completed")})},getRoute(t){var a=t.split("/").length;return"edit"===t.split("/")[a-1]}},mounted(){this.lang_id=2,this.$store.state.dataForm=[],this.updatePage&&this.$store.dispatch("singleNews",{id:this.$route.params.id}).then(()=>{for(let i=1;i<=3;i++){let r=[];var t=i;if(this.news[t].id?r=this.news[t]:(r=(r=(r=Object.keys(this.news).map((t,a)=>{if(this.news[t].lang_id)return this.news[t]})).filter(t=>null!=t)).find(t=>null!==t.id),this.form[i].description="",this.form[i].name=""),this.image=r.image,this.news[i].name)for(var a in this.form[t])if(r[a])if(Array.isArray(this.form[t][a])){for(var e in this.form[t][a])if(r[a][e])for(var s in this.form[t][a][e])this.form[t][a][e][s]=r[a][e][s]}else this.form[t][a]=r[a],this.form[t].available=parseInt(r.available),r.image&&(this.form[t].image=r.image.split("/").pop())}})},watch:{lang_id:function(t){Vue.ls.set("language",t)}},computed:{news(){return this.$store.getters.getSingleNews}}}),f=e(11);f=Object(f.a)(u,(function(){var t=this,a=t._self._c;return a("div",{attrs:{id:"add-item-page"}},[a("Navbar",{attrs:{tabs:[{News:"Blog","Add News":"Add Article"}],heading:"Blog","email-page":!0}}),t._v(" "),a(l.a,{ref:"form",staticClass:"add-news",attrs:{method:"POST",enctype:"multipart/form-data"},model:{value:t.form.valid,callback:function(a){t.$set(t.form,"valid",a)},expression:"form.valid"}},[a("input",{attrs:{type:"hidden",name:"_token"},domProps:{value:t.csrf}}),t._v(" "),a("div",[a("h4",{staticClass:"form-title"},[t._v(t._s(t.updatePage?"Edit Article":"Add Article"))]),t._v(" "),a("ul",{staticClass:"list-group-inline"},[a("li",{staticClass:"nav-item",attrs:{"data-id":"3"}},[a("a",{staticClass:"nav-link",class:{active:t.isActive(3)},attrs:{href:"#rus"},on:{click:function(a){return a.preventDefault(),t.setActive(a,3)}}},[t._v("RUS")])]),t._v(" "),a("li",{staticClass:"nav-item",attrs:{"data-id":"1"}},[a("a",{staticClass:"nav-link",class:{active:t.isActive(1)},attrs:{href:"#eng"},on:{click:function(a){return a.preventDefault(),t.setActive(a,1)}}},[t._v("ENG")])]),t._v(" "),a("li",{staticClass:"nav-item",attrs:{"data-id":"2"}},[a("a",{staticClass:"nav-link",class:{active:t.isActive(2)},attrs:{href:"#ro"},on:{click:function(a){return a.preventDefault(),t.setActive(a,2)}}},[t._v("RO")])])])]),t._v(" "),a("div",{staticClass:"tab-content py-3",attrs:{id:"addNewsTabs"}},[a("div",{staticClass:"tab-pane fade",class:{"active show":t.isActive(1)},attrs:{id:"eng"}},[a(r.a,[a(c.a,[a("h5",{staticClass:"row-title"},[t._v("Visibility")]),t._v(" "),a(i.a,{attrs:{cols:"12"}},[a(n.a,{attrs:{row:"",mandatory:""},model:{value:t.form[1].available,callback:function(a){t.$set(t.form[1],"available",a)},expression:"form[1].available"}},[a(o.a,{attrs:{color:"success",value:1,label:"Show"}}),t._v(" "),a(o.a,{attrs:{color:"success",value:0,label:"Hide"}})],1)],1)],1),t._v(" "),a(c.a,[a("h5",{staticClass:"row-title"},[t._v("Article")]),t._v(" "),a(i.a,{attrs:{cols:"12"}},[a(d.a,{attrs:{placeholder:"Name",required:"",rules:t.form[1].nameRules},model:{value:t.form[1].name,callback:function(a){t.$set(t.form[1],"name",a)},expression:"form[1].name"}})],1)],1),t._v(" "),a(c.a,[a(i.a,{attrs:{cols:"12"}},[a("label",{staticClass:"add-to-item",attrs:{for:"img-upload"}},[t._v("\n                                "+t._s(t.image||"Add image")+"\n                                "),a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:"/assets/icons/img.jpg",expression:"'/assets/icons/img.jpg'"}],staticClass:"file-input-icon ml-2"})]),t._v(" "),a("input",{attrs:{type:"file",id:"img-upload"},on:{change:t.imageChosen}})])],1),t._v(" "),a(c.a,[a(i.a,{attrs:{cols:"12"}},[a(m.a,{attrs:{placeholder:"News description",required:"",name:"text"},model:{value:t.form[1].description,callback:function(a){t.$set(t.form[1],"description",a)},expression:"form[1].description"}})],1)],1),t._v(" "),a(c.a,{staticClass:"d-flex justify-content-end"},[a(s.a,{staticClass:"discard-form",attrs:{width:"auto"},on:{click:t.discard}},[t._v("\n                            Discard\n                        ")]),t._v(" "),t.updatePage?a(s.a,{staticClass:"submit-form",attrs:{width:"auto",right:""},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.update.apply(null,arguments)}}},[t._v("\n                            UPDATE\n                        ")]):a(s.a,{staticClass:"submit-form",attrs:{width:"auto",right:""},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.send.apply(null,arguments)}}},[t._v("\n                            SEND\n                        ")])],1),t._v(" "),a("input",{attrs:{type:"hidden"},domProps:{value:1}})],1)],1),t._v(" "),a("div",{staticClass:"tab-pane fade",class:{"active show":t.isActive(2)},attrs:{id:"ro"}},[a(r.a,[a(c.a,[a("h5",{staticClass:"row-title"},[t._v("Visibility")]),t._v(" "),a(i.a,{attrs:{cols:"12"}},[a(n.a,{attrs:{row:"",mandatory:""},model:{value:t.form[2].available,callback:function(a){t.$set(t.form[2],"available",a)},expression:"form[2].available"}},[a(o.a,{attrs:{color:"success",value:1,label:"Show"}}),t._v(" "),a(o.a,{attrs:{color:"success",value:0,label:"Hide"}})],1)],1)],1),t._v(" "),a(c.a,[a("h5",{staticClass:"row-title"},[t._v("Article")]),t._v(" "),a(i.a,{attrs:{cols:"12"}},[a(d.a,{attrs:{placeholder:"Name"},model:{value:t.form[2].name,callback:function(a){t.$set(t.form[2],"name",a)},expression:"form[2].name"}})],1)],1),t._v(" "),a(c.a,[a(i.a,{attrs:{cols:"12"}},[a("label",{staticClass:"add-to-item",attrs:{for:"img-upload"}},[t._v("\n                                "+t._s(t.image||"Add image")+"\n                                "),a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:"/assets/icons/img.jpg",expression:"'/assets/icons/img.jpg'"}],staticClass:"file-input-icon ml-2"})]),t._v(" "),a("input",{attrs:{type:"file",id:"img-upload"},on:{change:t.imageChosen}})])],1),t._v(" "),a(c.a,[a(i.a,{attrs:{cols:"12"}},[a(m.a,{attrs:{placeholder:"News description",required:"",name:"text"},model:{value:t.form[2].description,callback:function(a){t.$set(t.form[2],"description",a)},expression:"form[2].description"}})],1)],1),t._v(" "),a(c.a,{staticClass:"d-flex justify-content-end"},[a(s.a,{staticClass:"discard-form",attrs:{width:"auto"},on:{click:t.discard}},[t._v("\n                            Discard\n                        ")]),t._v(" "),t.updatePage?a(s.a,{staticClass:"submit-form",attrs:{width:"auto",right:""},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.update.apply(null,arguments)}}},[t._v("\n                            UPDATE\n                        ")]):a(s.a,{staticClass:"submit-form",attrs:{width:"auto",right:""},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.send.apply(null,arguments)}}},[t._v("\n                            SEND\n                        ")])],1),t._v(" "),a("input",{attrs:{type:"hidden"},domProps:{value:2}})],1)],1),t._v(" "),a("div",{staticClass:"tab-pane fade",class:{"active show":t.isActive(3)},attrs:{id:"rus"}},[a(r.a,[a(c.a,[a("h5",{staticClass:"row-title"},[t._v("Visibility")]),t._v(" "),a(i.a,{attrs:{cols:"12"}},[a(n.a,{attrs:{row:"",mandatory:""},model:{value:t.form[3].available,callback:function(a){t.$set(t.form[3],"available",a)},expression:"form[3].available"}},[a(o.a,{attrs:{color:"success",value:1,label:"Show"}}),t._v(" "),a(o.a,{attrs:{color:"success",value:0,label:"Hide"}})],1)],1)],1),t._v(" "),a(c.a,[a("h5",{staticClass:"row-title"},[t._v("Article")]),t._v(" "),a(i.a,{attrs:{cols:"12"}},[a(d.a,{attrs:{placeholder:"Name"},model:{value:t.form[3].name,callback:function(a){t.$set(t.form[3],"name",a)},expression:"form[3].name"}})],1)],1),t._v(" "),a(c.a,[a(i.a,{attrs:{cols:"12"}},[a("label",{staticClass:"add-to-item",attrs:{for:"img-upload"}},[t._v("\n                                "+t._s(t.image||"Add image")+"\n                                "),a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:"/assets/icons/img.jpg",expression:"'/assets/icons/img.jpg'"}],staticClass:"file-input-icon ml-2"})]),t._v(" "),a("input",{attrs:{type:"file",id:"img-upload"},on:{change:t.imageChosen}})])],1),t._v(" "),a(c.a,[a(i.a,{attrs:{cols:"12"}},[a(m.a,{attrs:{placeholder:"News description",required:"",name:"text"},model:{value:t.form[3].description,callback:function(a){t.$set(t.form[3],"description",a)},expression:"form[3].description"}})],1)],1),t._v(" "),a(c.a,{staticClass:"d-flex justify-content-end"},[a(s.a,{staticClass:"discard-form",attrs:{width:"auto"},on:{click:t.discard}},[t._v("\n                            Discard\n                        ")]),t._v(" "),t.updatePage?a(s.a,{staticClass:"submit-form",attrs:{width:"auto",right:""},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.update.apply(null,arguments)}}},[t._v("\n                            UPDATE\n                        ")]):a(s.a,{staticClass:"submit-form",attrs:{width:"auto",right:""},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.send.apply(null,arguments)}}},[t._v("\n                            SEND\n                        ")])],1),t._v(" "),a("input",{attrs:{type:"hidden"},domProps:{value:3}})],1)],1),t._v(" "),a("p",{staticClass:"text-center text-danger mt-3"},[t._v(t._s(t.form[t.lang_id].errors||""))]),t._v(" "),a("p",{staticClass:"text-center text-success mt-3"},[t._v(t._s(t.form[t.lang_id].success||""))])])])],1)}),[],!1,null,null,null);a.default=f.exports}}]);